# 効果的なプロンプトパターン集

## 基本原則

1. **具体的に指示する** - 対象ファイル、観点、期待する出力形式を明確に
2. **タスクを分割する** - 大きなタスクは小さな単位に分ける
3. **コンテキストを与える** - 背景情報や制約条件を伝える

---

## パターン別プロンプト例

### 1. バグ修正

#### 悪い例
```
バグを直して
```

#### 良い例
```
src/api/login.ts のログイン処理で、セッションが正しくクリアされない
バグがあります。

再現手順：
1. ログイン
2. ログアウト
3. 再度ログイン
4. 前回のセッション情報が残っている

login関数のセッション管理部分を確認して修正してください。
```

---

### 2. 新機能追加

#### 悪い例
```
ダッシュボードを作って
```

#### 良い例
```
管理者向けのダッシュボードを追加したいです。

要件：
- 日次のアクティブユーザー数をグラフ表示
- 直近7日間のデータを表示
- 期間フィルター（7日/30日/90日）

技術的な制約：
- 既存の src/components/ 配下にコンポーネントを追加
- グラフライブラリは recharts を使用
- APIは /api/analytics/ エンドポイントを新設

まず実装計画を立ててから、承認後に実装を開始してください。
```

---

### 3. コードレビュー依頼

#### 悪い例
```
このコード見て
```

#### 良い例
```
src/services/payment.ts の決済処理についてセキュリティ観点で
レビューしてください。

特に確認したい点：
- SQLインジェクションの可能性
- 金額計算の精度（浮動小数点の扱い）
- エラー時のロールバック処理

問題があれば、重要度（高/中/低）と修正案を提示してください。
```

---

### 4. リファクタリング

#### 悪い例
```
このコードきれいにして
```

#### 良い例
```
src/utils/helpers.ts が500行を超えて肥大化しています。
以下の方針でリファクタリングしてください。

方針：
- 機能ごとにファイルを分割（date.ts, string.ts, validation.ts）
- 各関数にJSDocコメントを追加
- 未使用の関数は削除

制約：
- 既存のインポートパスが壊れないようエクスポートを維持
- テストは既存のものがすべてパスすること
```

---

### 5. テスト作成

#### 悪い例
```
テスト書いて
```

#### 良い例
```
src/services/user.ts の createUser 関数のユニットテストを
作成してください。

テスト対象：
- 正常系：有効なデータでユーザー作成
- 異常系：メールアドレス重複
- 異常系：必須フィールド欠落
- 境界値：名前の最大長（100文字）

テストファイルは src/services/__tests__/user.test.ts に作成。
既存のテストパターンに合わせてください。
```

---

### 6. デバッグ依頼

#### 悪い例
```
動かないんだけど
```

#### 良い例
```
npm run dev で開発サーバーを起動すると以下のエラーが出ます。

エラーメッセージ：
```
TypeError: Cannot read property 'map' of undefined
    at UserList (src/components/UserList.tsx:15:23)
```

発生条件：
- ページ初回ロード時に必ず発生
- リロードすると正常に表示される

UserList.tsx:15行目付近のデータ取得処理を確認して、
原因と修正案を教えてください。
```

---

## 計画フェーズ向けプロンプト

### Planモードで使う

```
# 機能追加の計画を立てる
Shift+Tab でPlanモードに切り替えてから：

「ユーザー認証機能を追加したいです。
既存のコードベースを確認して、どのように実装すべきか
計画を立ててください。」

# 計画が提示されたら確認して承認
```

---

## コンテキスト管理のコツ

### 会話が長くなったら

```
/compact

# または明示的に要約を依頼
「ここまでの変更内容を要約して、次のステップを確認させてください」
```

### タスクを切り替えるとき

```
/clear

# 新しいタスクを開始
「次は別の機能を実装します。src/api/orders.ts に
注文APIを追加してください。」
```

---

## よくある失敗パターン

| 失敗パターン | 問題点 | 改善方法 |
|-------------|--------|---------|
| 丸投げ | AIが憶測で実装する | 要件・制約を具体的に |
| 巨大タスク | 品質が下がる | 小さなタスクに分割 |
| 曖昧な表現 | 意図と異なる結果 | 対象ファイル・行を指定 |
| 背景情報なし | 既存コードと不整合 | 制約・規約を伝える |
